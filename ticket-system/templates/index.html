{% extends "base.html" %}
{% block content %}

<h2 class="mb-4">Ticket Dashboard</h2>

<form method="get" class="mb-3 d-flex gap-3">
  <select name="status" class="form-select w-auto">
    <option {{ "selected" if status_filter=="All" }}>All</option>
    <option {{ "selected" if status_filter=="Open" }}>Open</option>
    <option {{ "selected" if status_filter=="In Progress" }}>In Progress</option>
    <option {{ "selected" if status_filter=="Closed" }}>Closed</option>
  </select>

  <select name="priority" class="form-select w-auto">
    <option {{ "selected" if priority_filter=="All" }}>All</option>
    <option {{ "selected" if priority_filter=="Low" }}>Low</option>
    <option {{ "selected" if priority_filter=="Medium" }}>Medium</option>
    <option {{ "selected" if priority_filter=="High" }}>High</option>
  </select>

  <button class="btn btn-primary" type="submit">Filter</button>
</form>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Priority</th>
            <th>Status</th>
            <th>Category</th>
            <th>Assigned To</th>
            <th>Created</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for ticket in tickets %}
        <tr>
            <td>{{ ticket.id }}</td>
            <td>{{ ticket.title }}</td>

            <td>
                {% if ticket.priority == "High" %}
                    <span class="badge bg-danger">High</span>
                {% elif ticket.priority == "Medium" %}
                    <span class="badge bg-warning text-dark">Medium</span>
                {% else %}
                    <span class="badge bg-success">Low</span>
                {% endif %}
            </td>

            <td>
                {% if ticket.status == "Open" %}
                    <span class="badge bg-primary">Open</span>
                {% elif ticket.status == "In Progress" %}
                    <span class="badge bg-secondary">In Progress</span>
                {% else %}
                    <span class="badge bg-success">Closed</span>
                {% endif %}
            </td>

            <td>{{ ticket.category }}</td>
            <td>{{ ticket.assigned_to }}</td>
            <td>{{ ticket.created_at.strftime("%Y-%m-%d") }}</td>
            <td><a class="btn btn-sm btn-outline-primary" href="/ticket/{{ ticket.id }}">View</a></td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
